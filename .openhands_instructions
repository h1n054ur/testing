üéØ **SYSTEM INSTRUCTION FOR CLAUDE (TWILIO MANAGER CLI)**

You are building a **menu-driven CLI application** that integrates with Twilio and follows a strict layered architecture:

```
CLI Interfaces ‚Üí Use Cases ‚Üí Services ‚Üí Core Logic ‚Üí Gateways
```

All behavior, folder structure, and interaction patterns must comply with the official **specs fetched from the MCP server** via `fetch_spec2`.

---

### ‚úÖ MANDATORY PROTOCOLS

1. **Always reset architecture context before any action**:
   ```
   fetch_spec{"spec_name":"architecture"}
   ```

2. **Reset user interaction model**:
   ```
   fetch_spec{"spec_name":"user_flow"}
   ```

3. **Load the relevant flow or feature spec**:
   ```
   fetch_spec{"spec_name":"<flow_spec_name>"}
   ```

4. **Declare your working phase**:
   ```
   set_phase{"phase":"<phase_name>"}
   ```

5. **Create a Git branch before applying patches**:
   ```
   create_branch{"name":"<feature_branch_name>"}
   ```

6. **Ask for confirmation before pushing changes**:
   ```
   confirm_before_push{"branch":"<branch_name>"}
   ```

7. **Log all architectural or routing decisions**:
   ```
   log_decision{"context":"<context_name>", "decision":"<rationale>"}
   ```

8. **Manually verify CLI behavior** after applying changes.

---

### ‚úÖ ENFORCED SYSTEM BEHAVIOR

- `architecture_rules` is **automatically triggered** for every patch.  
- This ensures clean separation across all layers, prevents SDK leaks, and blocks SID prompts or print logic from CLI.
- CLI menus must use:
  - `BaseMenu.render_panel()` for all output
  - `self.subaccount_label` in every header
  - Only numbered inputs for selection ‚Äî no SID typing

- Exports and logs must go through:
  - `export_service` (for CSV/JSON)
  - `logging_setup` (for rotating logs)

---

### ‚ùå PROHIBITED ACTIONS

- ‚ùå Never write Twilio logic inside CLI menus.
- ‚ùå Never bypass `fetch_spec2` to access architecture or flows.
- ‚ùå Never commit changes not scoped to a loaded spec.
- ‚ùå Never prompt the user for raw SIDs or print directly from menus.
- ‚ùå Never allow any cross-layer coupling (e.g., use_case ‚Üí gateway).

---
